import Code from "../../../components/Code.jsx"

# Client Side Rendering

## Conteúdo Dinâmico

![](/imgs/fetch/preview.png)

Código:

```text
hosts-app
├── back
│   ├── .gitignore
│   ├── db.json
│   ├── package-lock.json
│   ├── package.json
│   ├── resquest.http
│   └── src
│       └── index.js
└── front
    ├── index.html
    └── js
        ├── index.js
        └── services
            └── api.js
```

### Front

[![Edit host-app-front](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/host-app-front-uvrug?fontsize=14&hidenavigation=1&theme=dark)

hosts-app/front/index.html:

<Code src="/codes/fetch/hosts-app/front/index.html" lang="html" />

hosts-app/front/js/index.js:

<Code src="/codes/fetch/hosts-app/front/js/index.js" lang="js" />

### Back

[![Edit host-app-back](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/host-app-back-moeem?fontsize=14&hidenavigation=1&theme=dark)

REST API

| Método | Caminho    | Resposta                |
| ------ | ---------- | ----------------------- |
| POST   | `/hosts`   | Cria uma novo host      |
| GET    | `/hosts`   | Retorna todas os hosts  |
| GET    | `/hosts/1` | Retorna o host de ID 1  |
| PUT    | `/hosts/1` | Atualiza o host de ID 1 |
| DELETE | `/hosts/1` | Exclui o host de ID 1   |

hosts-app/back/db.json:

<Code src="/codes/fetch/hosts-app/back/db.json" lang="json" />

hosts-app/back/src/index.js:

<Code src="/codes/fetch/hosts-app/back/src/index.js" lang="js" />

[json-server](https://github.com/typicode/json-server):

```text
$ npm init -y
$ npm install json-server
```

hosts-app/back/package.json:

<Code src="/codes/fetch/hosts-app/back/package.json" lang="json" />

```text
$ npm start
```

[localhost:3000/hosts](http://localhost:3000/hosts):

```json
[
  {
    "name": "Server",
    "address": "10.0.0.10",
    "mask": "255.255.255.0",
    "id": 1
  },
  {
    "name": "PC 1",
    "address": "192.168.0.1",
    "mask": "255.255.255.0",
    "id": 2
  }
]
```

back/request.http ([VS Code - Rest Client](https://marketplace.visualstudio.com/items?itemName=humao.rest-client)):

```text
### Create Host

### Read Hosts

GET http://localhost:3000/hosts

### Read Host by ID

### Update Host

### Delete Host
```

## Fetch API

front/js/services/api.js:

```js
const domain = 'http://localhost:3000';

async function create(resource, data) {}

async function read(resource) {}

async function update(resource, data) {}

async function destroy(resource) {}

export default { create, read, update, destroy };
```

### Read

Request (Codesandbox - [Read](https://moeem.sse.codesandbox.io/hosts)):

![](/imgs/fetch/read-hosts.png)

```txt
### Read Hosts

GET http://localhost:3000/hosts
```

Code:

```js
async function read(resource) {
  const res = await fetch(`${domain}${resource}`);

  return await res.json();
}
```

```js
api.read('/hosts');
```

### Create

Resquest ([REQBIN - Create](https://reqbin.com/75sw4s9x)):

![](/imgs/fetch/create-host.png)

```text
### Create Host

POST http://localhost:3000/hosts
Content-Type: application/json

{
  "name": "PC 2",
  "address": "192.168.0.2",
  "mask": "255.255.255.0"
}
```

Code:

```js
async function create(resource, data) {
  const res = await fetch(`${domain}${resource}`, {
    method: 'post',
    body: JSON.stringify(data),
    headers: {
      'Content-Type': 'application/json; charset=UTF-8',
    },
  });

  return await res.json();
}
```

```js
const host = {
  name: "PC 2",
  address: "192.168.0.2",
  mask: "255.255.255.0"
}

api.create('/hosts', host);
```

### Update

Resquest ([REQBIN - Upadte](https://reqbin.com/rmigtirs)):

![](/imgs/fetch/update-host.png)

```text
### Update Host

PUT http://localhost:3000/hosts/3
Content-Type: application/json

{
  "name": "PC 2",
  "address": "192.168.0.20",
  "mask": "255.255.255.0"
}
```

Code:

```js
async function update(resource, data) {
  const res = await fetch(`${domain}${resource}`, {
    method: 'put',
    body: JSON.stringify(data),
    headers: {
      'Content-Type': 'application/json; charset=UTF-8',
    },
  });

  return await res.json();
}
```

```js
const host = {
  name: "PC 2",
  address: "192.168.0.20",
  mask: "255.255.255.0"
}

api.update('/hosts/3', host);
```

### Delete

Request ([REQBIN - Delete](https://reqbin.com/8cwfroas))

![](/imgs/fetch/delete-host.png)

```text
### Delete Host

DELETE http://localhost:3000/hosts/3
```

Code:

```js
async function destroy(resource) {
  await fetch(`${domain}${resource}`, {
    method: 'delete',
  });
}
```

```js
api.destroy('/hosts/1');
```
